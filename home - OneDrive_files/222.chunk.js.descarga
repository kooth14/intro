(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["222"],{"671":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("driveItem",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0}),itemId:Object(r.s)()})},"684":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(1007),s=new r.e("allPhotosRootItemSet",{photosRootKeyPart:Object(r.o)(i.e),groupBy:Object(r.s)(),filter:Object(r.s)(),filterType:Object(r.r)({folder:0,tag:1,album:2,place:3,onthisday:4,onthismonth:5,lastweekpreviousyears:6})})},"826":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(42),i=n(671),s=n(1174),o=new r.e("driveItemSet",{driveItemKey:Object(r.o)(i.e),sortBy:Object(r.s)(),isAscending:Object(r.n)(),extFilters:Object(r.t)(Object(r.s)()),filters:Object(r.t)(Object(r.o)(s.e)),groupBy:Object(r.s)()})},"834":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.Date="Date"})(r||(r={}))},"852":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("albumsRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"879":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(852),s=new r.e("albumKey",{albumsRootKeyPart:Object(r.o)(i.e),id:Object(r.s)()})},"1007":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("photosRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1026":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("tagsRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1027":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("placesRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1028":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(852),s=new r.e("albumSetKey",{albumsRootKeyPart:Object(r.o)(i.e),groupType:Object(r.r)({auto:0,all:1})})},"1077":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(1027),s=new r.e("placeSetKey",{placesRootKeyPart:Object(r.o)(i.e),countryOrRegion:Object(r.s)(),state:Object(r.s)(),locality:Object(r.s)(),city:Object(r.s)()})},"1078":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(42),i=n(1026),s=new r.e("tagKey",{tagsRootKeyPart:Object(r.o)(i.e),id:Object(r.s)()})},"1090":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("recentRootItem",{endpoint:Object(r.s)()})},"1174":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("driveFilter",{type:Object(r.s)(),values:Object(r.t)(Object(r.s)())})},"1235":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("sharedRootItem",{endpoint:Object(r.s)()})},"1326":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("onThisMonthKey",{driveId:Object(r.s)(),endpoint:Object(r.s)(),resourceId:Object(r.s)(),date:Object(r.s)(),applyUtilityFiltering:Object(r.n)()})},"1327":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("lastWeekPreviousYearsKey",{driveId:Object(r.s)(),endpoint:Object(r.s)(),resourceId:Object(r.s)(),date:Object(r.s)(),applyUtilityFiltering:Object(r.n)()})},"1364":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e,t){e.setHours(0,0,0,0);return JSON.stringify({date:e.toISOString(),resourceId:t})}function i(e){var t=JSON.parse(e);return{date:new Date(t.date),resourceId:t.resourceId}}},"1365":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("onThisDayKey",{driveId:Object(r.s)(),endpoint:Object(r.s)(),resourceId:Object(r.s)(),date:Object(r.s)()})},"1389":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e,t,n){e.setHours(0,0,0,0);return JSON.stringify({date:e.toISOString(),resourceId:t,applyUtilityFiltering:n})}function i(e){var t=JSON.parse(e);return{date:new Date(t.date),resourceId:t.resourceId,applyUtilityFiltering:t.applyUtilityFiltering}}},"1390":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e,t,n){e.setHours(0,0,0,0);return JSON.stringify({date:e.toISOString(),resourceId:t,applyUtilityFiltering:n})}function i(e){var t=JSON.parse(e);return{date:new Date(t.date),resourceId:t.resourceId,applyUtilityFiltering:t.applyUtilityFiltering}}},"1517":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(42),i=new r.e("sharedByMeRootItem",{endpoint:Object(r.s)()})},"1895":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];t[s]||(n[s]=e[s])}return n}function i(e,t){for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];t[s]&&(n[s]=e[s])}return n}},"2673":function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(36),s=n(826),o=n(671),u=n(684),a=n(1026),f=n(1027),l=n(834),c=n(852),h=n(1028),p=n(10),d=n(91),v=n(1090),m=n(1235),g=n(1517),y=n(1364),b=n(1389),w=n(1390),E=n(354),S=n(287),x=n(233),T=n(1361),N=["albums","tags","places"];var C=n(0),k=n(1078),L=n(1077),A=n(879),O=n(1365),M=n(1326),_=n(1327),D=n(4),P=n(1895);n.d(t,"ItemsScopeKeyConverter",function(){return H});n.d(t,"resourceKey",function(){return B});var H=function(e,t){this.itemKeyToStoreKeyControlHandler=function(e,t){var n=(function(e,t){var n,r,a,f,l,N,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z=t.itemKey,ee=t.viewParams;ee=Object(P.t)(ee,((n={}).mid=!0,n.mcid=!0,n));var te=e.demandItemFacet(o.e,Z),ne=e.demandItemFacet(s.e,Z),re=e.demandItemFacet(v.e,Z),ie=e.demandItemFacet(T.e,Z),se=e.demandItemFacet(m.e,Z),oe=e.demandItemFacet(g.e,Z),ue=e.demandItemFacet(h.e,Z),ae=e.demandItemFacet(A.e,Z),fe=e.demandItemFacet(c.e,Z),le=e.demandItemFacet(L.e,Z),ce=e.demandItemFacet(k.e,Z),he=e.demandItemFacet(O.e,Z),pe=e.demandItemFacet(M.e,Z),de=e.demandItemFacet(_.e,Z),ve=e.demandItemFacet(u.e,Z),me=e.demandItemFacet(x.s,Z);if(ie){console.log("localItemKey: "+ie.localItemKey+" - remoteItemKey: "+ie.remoteItemKey);var ge=e.demandItemFacet(o.e,ie.localItemKey),ye=e.demandItemFacet(s.e,ie.remoteItemKey);K=null==ye?void 0:ye.driveItemKey.itemId;Q=null==ye?void 0:ye.driveItemKey.driveId;G=null==ge?void 0:ge.itemId;Y=null==ge?void 0:ge.driveId;"root"!==K&&(K=K.toUpperCase());if(ye&&Q&&G&&Y){J=Object(d.r)(((r={}).id=K,r.cid=Q.toUpperCase(),r.mid=G,r.mcid=Y.toUpperCase(),r));var be=ye.isAscending;ee=Object(C.__assign)(Object(C.__assign)({},ee),{id:K,cid:Q,mid:G,mcid:Y,sb:E.e[ye.sortBy],sd:be?S.e.ascending.toString():S.e.descending.toString()})}}else if(te){Q=te.driveId;"root"!==(K=te.itemId)&&(K=K.toUpperCase());J=Object(d.r)(((a={}).driveId=Object(D.isFeatureEnabled)(D.ConvergenceEnabled)&&te.driveId||"",a.id=K,a.cid=Q.toUpperCase(),a))}else if(ne){var we=ne.driveItemKey.driveId;"root"!==(K=ne.driveItemKey.itemId)&&(K=K.toUpperCase());J=Object(d.r)(((f={}).driveId=Object(D.isFeatureEnabled)(D.ConvergenceEnabled)&&ne.driveItemKey.driveId||"",f.id=K,f.cid=we.toUpperCase(),f));be=ne.isAscending;ee=Object(C.__assign)(Object(C.__assign)({},ee),{sb:E.e[ne.sortBy],sd:be?S.e.ascending.toString():S.e.descending.toString()})}else if(re){J=Object(d.a)(p.e.Recent);K="root"}else if(se){J=Object(d.a)(p.e.SharedWithMe);K="root"}else if(oe){J=Object(d.a)(p.e.SharedByMe);K="root"}else if(fe){K="albums";J=Object(d.r)(((l={}).id=K,l.cid=fe.driveId,l))}else if(ue&&"auto"===ue.groupType){K="albums";J=Object(d.r)(((N={}).id=K,N.cid=ue.albumsRootKeyPart.driveId,N.tagFilter="__New",N))}else if(ae){K=ae.id;J=Object(d.r)(((H={}).id=K,H.cid=ae.albumsRootKeyPart.driveId,H))}else if(le){K="root";J=Object(d.r)(((B={}).id="root",B.cid=le.placesRootKeyPart.driveId,B.qt="allmyphotos",B.locationFilter=Object(i.i)(le.countryOrRegion,le.state,le.city,le.locality),B))}else if(ce){K="root";J=Object(d.r)(((j={}).id="root",j.cid=ce.tagsRootKeyPart.driveId,j.qt="allmyphotos",j.tagFilter=ce.id,j))}else if(he)J=Object(d.r)(((F={}).id=he.resourceId,F.cid=he.driveId,F.qt="allmyphotos",F.onThisDay=!0,F.sc="0",F));else if(pe)J=Object(d.r)(((I={}).id=pe.resourceId,I.cid=pe.driveId,I.qt="allmyphotos",I.onThisMonth=!0,I.sc="0",I.startDate=pe.date,I.useUtilityFiltering=pe.applyUtilityFiltering,I));else if(de)J=Object(d.r)(((q={}).id=de.resourceId,q.cid=de.driveId,q.qt="allmyphotos",q.lastWeekPreviousYears=!0,q.sc="0",q.startDate=de.date,q.useUtilityFiltering=de.applyUtilityFiltering,q));else if(ve)switch(ve.filterType){case"folder":K=ve.filter;J=Object(d.r)(((R={}).v="photos",R.id=ve.filter,R.cid=ve.photosRootKeyPart.driveId,R.qt="allmyphotos",R));break;case"place":K="root";J=Object(d.r)(((U={}).v="photos",U.id="root",U.cid=ve.photosRootKeyPart.driveId,U.qt="allmyphotos",U.locationFilter=ve.filter,U));break;case"tag":K="root";J=Object(d.r)(((z={}).v="photos",z.id="root",z.cid=ve.photosRootKeyPart.driveId,z.qt="allmyphotos",z.tagFilter=ve.filter,z));break;case"album":K="root";J=Object(d.r)(((W={}).v="photos",W.id=ve.filter,W.cid=ve.photosRootKeyPart.driveId,W));break;case"onthisday":var Ee=Object(y.e)(ve.filter);J=Object(d.r)(((X={}).id=Ee.resourceId,X.cid=ve.photosRootKeyPart.driveId,X.qt="allmyphotos",X.onThisDay=!0,X.startDate=Ee.date.toISOString(),X));break;case"onthismonth":var Se=Object(b.e)(ve.filter);J=Object(d.r)(((V={}).id=Se.resourceId,V.cid=ve.photosRootKeyPart.driveId,V.qt="allmyphotos",V.onThisMonth=!0,V.startDate=Se.date.toISOString(),V.useUtilityFiltering=Se.applyUtilityFiltering,V));break;case"lastweekpreviousyears":var xe=Object(w.e)(ve.filter);J=Object(d.r)((($={}).id=xe.resourceId,$.cid=ve.photosRootKeyPart.driveId,$.qt="allmyphotos",$.lastWeekPreviousYears=!0,$.startDate=xe.date.toISOString(),$.useUtilityFiltering=xe.applyUtilityFiltering,$))}else if(me){J=Object(d.a)(me.queryType);K="root"}return{key:J,viewParams:ee,id:K}})(e,{itemKey:t.itemKey,viewParams:t.viewParams}),r=n.key,a=n.viewParams,f=n.id;return"string"==typeof r?{storeKey:{key:r,viewParams:a,id:f}}:{}};this.viewParamsToItemKeyControlHandler=function(e,t){var n=(function(e){var t,n,r=e.viewParams,C=e.isNavigation,k=r?Object(d.u)(r):p.e.Files,L=Object(d.i)(Object(d.n)(r)),A=L.id,O=L.tagFilter,M=L.locationFilter,_=null!==(n=null!==(t=r.driveId)&&void 0!==t?t:r.cid)&&void 0!==n?n:"me",D=Object(i.s)();if(Object(i.y)(r))return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:O,filterType:"tag"});if(Object(i.g)(r))return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:M,filterType:"place"});if(Object(i.m)(r))return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:A,filterType:"album"});if(Object(i.l)(r))return a.e.serialize({driveId:_,endpoint:D});if(Object(i.f)(r))return f.e.serialize({driveId:_,endpoint:D});if(Object(i.b)(r))return h.e.serialize({albumsRootKeyPart:{driveId:_,endpoint:D},groupType:"auto"});if(Object(i.u)(r))return c.e.serialize({driveId:_,endpoint:D});if(Object(i.d)(r)){var P=new Date;if(j=r.startDate){var H=new Date(j);isNaN(H.getTime())||(P=H)}var B=Object(y.t)(P,"root");return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:B,filterType:"onthisday"})}if(Object(i.v)(r)){var j=r.startDate;H=new Date(j),B=Object(b.t)(H,"root","true"===r.useUtilityFiltering.toLowerCase());return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:B,filterType:"onthismonth"})}if(Object(i.p)(r)){j=r.startDate,H=new Date(j),B=Object(w.t)(H,"root","true"===r.useUtilityFiltering.toLowerCase());return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:B,filterType:"lastweekpreviousyears"})}if(k===p.e.Files){var F=r.mid,I=r.mcid;I=I&&I.toLowerCase();var q=F&&I,R=(r&&r.sd)===S.e.ascending.toString(),U=E.e[r&&r.sb]||"";if(q){var z=r.id,W=r.cid;W=W&&W.toLowerCase();var X=o.e.serialize({itemId:z,driveId:W,endpoint:D}),V=s.e.serialize({driveItemKey:{itemId:z,driveId:W,endpoint:D},isAscending:R,sortBy:U}),$=C?V:X;return T.e.serialize({localItemKey:o.e.serialize({itemId:F,driveId:I,endpoint:D}),remoteItemKey:$})}if(A&&_){var J=Object(i.n)(r);J=J&&J.toLowerCase();var K=r&&r.cid&&J&&J!==r.cid.toLowerCase();return C?s.e.serialize({driveItemKey:{itemId:A,driveId:K?J:_,endpoint:D},isAscending:R,sortBy:U}):o.e.serialize({itemId:A,driveId:K?J:_,endpoint:D})}}else{if(k===p.e.Recent)return v.e.serialize({endpoint:D});if(k===p.e.SharedWithMe)return m.e.serialize({endpoint:D});if(k===p.e.SharedByMe)return g.e.serialize({endpoint:D});if(k===p.e.RecycleBin)return x.s.serialize({queryType:p.e.RecycleBin});if(k===p.e.AllMyPhotos){var Q=A;-1!==N.indexOf(Q)&&(Q="root");return u.e.serialize({photosRootKeyPart:{driveId:_,endpoint:D},groupBy:l.e.Date,filter:Q,filterType:"folder"})}}})({viewParams:t.viewParams,isNavigation:t.isNavigation});return n?{itemKey:n}:{}}},B=Object(r.s)("ItemsScopeKeyConverter",H,{})}}]);