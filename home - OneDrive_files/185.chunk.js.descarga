(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["185"],{"686":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(25),s=n(7),o=n(6),u=n(144),a=n(5),f=n(194),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.s.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.C.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.s.lazy.optional,itemSetSelectionModel:o.C.lazy.optional,selectionHelper:u.t.lazy.optional}))},"735":function(e,t,n){"use strict";n.d(t,"t",function(){return a});var r=n(0),i=n(7),s=n(1170),o=n(5),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?r.resources.consume(s.e):i;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandProvider:s.e});return t})(i.n);t.e=u;var a=Object(o.s)("ItemCommandHelper",u)},"973":function(e,t,n){"use strict";var r=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.e=r},"1170":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(7),s=n(15),o=n(5),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandDataSource:s.M});return t})(i.n),a=Object(o.s)("ItemCommandProvider",u)},"1259":function(e,t,n){"use strict";var r;(function(e){e[e.update=0]="update";e[e.leftNav=1]="leftNav";e[e.quotaBlock=2]="quotaBlock";e[e.frozenBlock=3]="frozenBlock";e[e.manageStorage=4]="manageStorage";e[e.lockedBlock=5]="lockedBlock";e[e.dragAndDrop=6]="dragAndDrop";e[e.premiumLeftNav=7]="premiumLeftNav";e[e.quotaBanner=8]="quotaBanner"})(r||(r={}));t.e=r},"1260":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(201).e)("Item",1)},"1287":function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"i",function(){return u});n.d(t,"r",function(){return a});n.d(t,"f",function(){return f});n.d(t,"s",function(){return l});n.d(t,"a",function(){return c});n.d(t,"u",function(){return h});n.d(t,"o",function(){return p});n.d(t,"l",function(){return d});var r=n(973),i=new r.e("createExcel"),s=new r.e("createOneNote"),o=new r.e("createPowerPoint"),u=new r.e("createWord"),a=new r.e("createSurvey"),f=new r.e("viewSurvey"),l=new r.e("editSurvey"),c=new r.e("publishSurvey"),h=new r.e("openOnline"),p=new r.e("openInClient"),d=new r.e("viewVersionHistory");new r.e("openInPowerBI"),new r.e("contentTypeNavigation"),new r.e("editNewMenu"),new r.e("uploadTemplate")},"1313":function(e,t,n){"use strict";var r;(function(e){e[e.unknown=0]="unknown";e[e.none=1]="none";e[e.learnMore=2]="learnMore";e[e.upgrade=3]="upgrade";e[e.cleanUpFiles=4]="cleanUpFiles";e[e.manageStorage=5]="manageStorage";e[e.wac=6]="wac";e[e.officePlans=7]="officePlans"})(r||(r={}));t.e=r},"1461":function(e,t,n){"use strict";var r=n(37),i=(function(){function e(){}e.IsProblematicLocale=function(t){null===e._problematicLocalesMap&&e.InitializeProblematicLocales();t&&(t=t.toLowerCase());return e._problematicLocalesMap[t]};e.convertToLocaleDateString=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase();return new Date(e).toLocaleDateString(n)}catch(e){return}};e.convertToDateString=function(e){var t=new RegExp(/(\d{4})\-(\d{1,2})\-(\d{1,2})/);if(e&&e.match(t))return e.replace(t,"$2/$3/$1")};e.convertToDayMonth=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase(),i=new Date(e),s=i.toLocaleString(n,{month:"short"});return r.format("{0}. {1}",i.getDate(),s)}catch(e){return}};e.convertToMonthDayYear=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase(),i=new Date(e),s=i.toLocaleString(n,{month:"long"});return r.format("{0} {1}, {2}",s,i.getDate(),i.getFullYear())}catch(e){return}};e.convertToLocaleString=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase();return new Date(e).toLocaleString(n)}catch(e){return}};e.getLongDateStringSafe=function(t,n){if(t){var r=new Date(t);if(r&&!isNaN(r.getTime())){try{if(!e.IsProblematicLocale(n))return r.toLocaleDateString(n,e._longDateFormatOptions)}catch(e){}return r.toLocaleDateString("en",e._longDateFormatOptions)}}};e.getDaysFromToday=function(e){var t=new Date(e).getTime()-(new Date).getTime();return Math.floor(t/864e5)};e.InitializeProblematicLocales=function(){e._problematicLocalesMap={};try{for(var t={month:"long"},n=0,r=e._chromeProblematicLocales;n<r.length;n++){var i=r[n];(new Date).toLocaleDateString(i,t).match("M[0-9][0-9]")&&(e._problematicLocalesMap[i]=!0)}}catch(e){}};e._chromeProblematicLocales=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"];e._longDateFormatOptions={year:"numeric",month:"long",day:"numeric"};e._problematicLocalesMap=null;return e})();t.e=i},"1512":function(e,t,n){"use strict";var r;(function(e){e[e.unknown=0]="unknown";e[e.inactive=1]="inactive";e[e.delinquent=2]="delinquent";e[e.other=3]="other"})(r||(r={}));t.e=r},"1602":function(e,t,n){"use strict";var r=n(0),i=n(191),s=n(1260),o=n(15),u=n(735),a=n(1287),f=n(686),l=n(6),c=n(123),h=n(18),p=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var r=t.openLocal,i=void 0!==r&&r,s=t.forceReadOnly,a=void 0!==s&&s,p=t.useDefaultAction,d=void 0!==p&&p;n._forceReadOnly=a;n._useDefaultAction=d;n._urlDataSource=n.resources.consume(o.be);n._viewParams=n.resources.consume(l.H);n._itemSelectionHelper=new(n.child(f.e))({overrideItem:t.item});n._itemCommandHelper=n.resources.consume(u.t);n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var v=!1;h.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(v=Object(c.n)());var m=n.resources.consume(l.e);n._navigationAction=new(n.managed(m.NavigationAction))({url:n._url,target:i||v?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}});return n}t.prototype._postProcessUrl=function(e){return e};t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,a.u)&&this._navigationAction.isAvailable()};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return t})(i.e);t.e=p},"1945":function(e,t,n){"use strict";var r=n(0),i=n(7),s=n(17),o=n(1286),u=n(32),a=n(11);Object(a.n)([{rawString:".od-UnlockConfirmation-dialog.od-Dialog-main{width:unset}.od-UnlockConfirmation-dialog .od-Dialog-actionsRight{width:max-content}.od-UnlockConfirmation-dialog .od-Dialog-inner{width:min-content}.od-UnlockConfirmation-dialog .od-Dialog-content{min-width:320px}.od-UnlockConfirmation-dialog .od-Dialog-actionsLoading{display:none}.od-UnlockConfirmation-dialogContent{padding-top:16px}.isFluent .od-UnlockConfirmation-dialogContent{padding-top:0}.od-UnlockConfirmation-dialogContent .od-unlockConfirmation-message{margin-bottom:24px;font-size:14px}.isFluent .od-UnlockConfirmation-dialogContent .od-unlockConfirmation-message{margin-bottom:16px}.od-UnlockConfirmation-dialogContent .od-unlockConfirmation-textInputLabel{margin-bottom:8px;font-size:14px;display:block}.isFluent .od-UnlockConfirmation-dialogContent .od-unlockConfirmation-textInputLabel{margin-bottom:4px}.isFluent .od-UnlockConfirmation-dialogContent .od-unlockConfirmation-textInputLabel p{margin:0}.od-UnlockConfirmation-dialogContent .od-UnlockConfirmation-status{margin-top:8px;font-size:12px}.od-UnlockConfirmation-dialogContent .od-UnlockConfirmation-status .od-UnlockConfirmation-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var f=n(9),l=n(37),c=n(1),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.unlockConfirmationInputLabel=l.format(o.e.unlockConfirmationLabel,"<strong>"+o.e.acknowledgementString+"</strong>");n.message=o.e.unlockConfimationMessage;n.inputText=n.createObservable("");n.isConfirmed=t.isConfirmed||c.observable(!1);n.status=t.status||c.observable("");n.hasError=t.hasError||c.observable(!1);n.statusVisible=t.statusVisible||c.observable(!0);n.createBackgroundComputed(function(){n.inputText().trim().toLocaleLowerCase()===o.e.acknowledgementString.trim().toLocaleLowerCase()?n.isConfirmed(!0):n.isConfirmed(!1)});return n}return t})(f.t),p=n(16).e({tagName:"od-unlock-confirmation",template:'<div class="od-UnlockConfirmation-dialogContent"><div class="od-unlockConfirmation-message" data-bind="text:message"></div><label for="od-unlockConfirmation-Input" class="od-unlockConfirmation-textInputLabel"><p data-bind="html:unlockConfirmationInputLabel"></p></label><input type="text" id="od-unlockConfirmation-Input" class="od-TextField-field" aria-required="true" data-bind="textInput:inputText,hasFocus:true,attr:{\'aria-invalid\':(isConfirmed()===false).toString()}"><div aria-live="assertive" role="status" class="od-UnlockConfirmation-status">\x3c!--ko if:statusVisible--\x3e<p data-bind="text:status,css:hasError()?\'od-UnlockConfirmation-error\':\'\'"></p>\x3c!--/ko--\x3e</div></div>',viewModel:h,synchronous:!0}),d=n(25),v=n(124),m=n(26),g=n(5);n.d(t,"e",function(){return b});var y=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.userStateProvider=r.resources.consume(u.y);r.dialogProvider=r.resources.consume(v.e);return r}t.prototype.confirmUnfreezeWithDialog=function(){var e=this,t={isConfirmed:this.createObservable(!1),status:this.createObservable(""),statusVisible:this.createObservable(!1),hasError:this.createObservable(!1)};return this.dialogProvider.requestDialog({customCssClasses:"od-UnlockConfirmation-dialog",title:o.e.confirmationTitle,component:{name:p.tagName,params:t},actions:[{name:o.e.startUnfreeze,execute:function(){return e._startUnlock(t)},isAvailable:t.isConfirmed,icon:new s.e("Unlock"),isDefault:!0},{name:o.e.notNow,execute:function(){return d.n.wrap(2)},isAvailable:this.createObservable(!0),icon:new s.e("Cancel")}]}).wait().then(function(){return{resultType:m.e.Success}})};t.prototype._startUnlock=function(e){e.hasError(!1);e.status(o.e.requestingUnlock);e.statusVisible(!0);return this.userStateProvider.unlockAccount().then(function(){return 2},function(){e.status(o.e.genericError);e.hasError(!0);e.statusVisible(!0);return 1})};return t})(i.n),b=Object(g.s)("UnfreezeHelper",y)},"1946":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-Dialog.od-Dialog--close .od-QuotaBlock .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-QuotaBlock-header{position:relative;width:100%;max-height:108px}.od-QuotaBlock-container{padding:18px 28px 18px 10px;background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";box-sizing:border-box;display:flex;width:100%}html[dir=rtl] .od-QuotaBlock-container{padding:18px 10px 18px 28px}html[dir=ltr] .od-QuotaBlock-container{float:left}html[dir=rtl] .od-QuotaBlock-container{float:right}.od-QuotaBlock-blue .od-QuotaBlock-container{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-title{font-size:21px;font-weight:100;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";align-self:center}[dir=ltr] .od-QuotaBlock-title{padding-left:16px}[dir=rtl] .od-QuotaBlock-title{padding-right:16px}.isFluent .od-QuotaBlock-title{font-weight:600;font-size:20px}.od-QuotaBlock-image{display:inline-block;height:76px;min-width:1px}html[dir=ltr] .od-QuotaBlock-image{float:left}html[dir=rtl] .od-QuotaBlock-image{float:right}.od-QuotaBlock-body{clear:both;position:relative;width:100%}.od-QuotaBlock-subheader{padding:22px 28px 8px 28px}html[dir=rtl] .od-QuotaBlock-subheader{padding:22px 28px 8px 28px}.isFluent .od-QuotaBlock-subheader{padding:22px 24px 16px 24px}html[dir=rtl] .isFluent .od-QuotaBlock-subheader{padding:22px 24px 16px 24px}.od-QuotaBlock-message{font-size:14px;font-weight:400}[dir=ltr] .od-QuotaBlock-message{padding-right:4px}[dir=rtl] .od-QuotaBlock-message{padding-left:4px}.od-QuotaBlock-link{white-space:nowrap;font-size:14px;font-weight:400;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-buttons{position:relative;padding:0 28px 12px 28px}html[dir=rtl] .od-QuotaBlock-buttons{padding:0 28px 12px 28px}.isFluent .od-QuotaBlock-buttons{padding:0 24px 16px 24px}html[dir=rtl] .isFluent .od-QuotaBlock-buttons{padding:0 24px 16px 24px}.od-QuotaBlock-status{padding:0 28px 12px 28px}html[dir=rtl] .od-QuotaBlock-status{padding:0 28px 12px 28px}.isFluent .od-QuotaBlock-status{padding:0}.isFluent .od-QuotaBlock-status p{margin:0 24px 16px}.od-QuotaBlock-status .od-QuotaBlock-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-QuotaBlock-button{position:relative;outline:0;min-height:48px;padding:8px 0}.od-QuotaBlock-button:focus{box-shadow:0 0 0 1px #767676 inset}.od-QuotaBlock-icon{position:absolute;width:48px;height:48px}.od-QuotaBlock-outer-icon{position:relative;width:48px;height:48px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-QuotaBlock-outer-icon .od-IconGlyph.ms-Icon{font-size:48px;line-height:48px}.od-QuotaBlock-button--clickable{cursor:pointer}.od-QuotaBlock-button--clickable .od-QuotaBlock-outer-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-inner-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;width:48px;top:0;bottom:0}.od-QuotaBlock-inner-icon .od-IconGlyph.ms-Icon{font-size:large;line-height:48px;width:100%;height:100%}[dir=ltr] .od-QuotaBlock-inner-icon .ms-Icon--Snowflake:before{margin-left:1px}[dir=rtl] .od-QuotaBlock-inner-icon .ms-Icon--Snowflake:before{margin-right:1px}[dir=ltr] .od-QuotaBlock-inner-icon{left:0}[dir=rtl] .od-QuotaBlock-inner-icon{right:0}.od-QuotaBlock-inner-image{position:absolute;top:0;bottom:0}[dir=ltr] .od-QuotaBlock-inner-image{left:0}[dir=rtl] .od-QuotaBlock-inner-image{right:0}.od-QuotaBlock-message-container{display:flex;min-height:48px}[dir=ltr] .od-QuotaBlock-message-container{padding-left:64px}[dir=rtl] .od-QuotaBlock-message-container{padding-right:64px}.od-QuotaBlock-text-container{align-self:center;display:block}.od-QuotaBlock-text{font-size:14px;font-weight:400;display:inline}[dir=ltr] .od-QuotaBlock-text{padding-right:4px}[dir=rtl] .od-QuotaBlock-text{padding-left:4px}.od-QuotaBlock-button-link{display:inline-block;white-space:nowrap}"}]);var i=n(16),s=n(0),o=n(9),u=n(51),a=n(37),f=n(17),l=n(407),c=n(161),h=n(1512),p=n(1259),d=n(124),v=n(6),m=n(75),g=n(1313),y=n(32),b=n(1945),w=n(1461),E=n(1602),S=n(2257),x=n(1286),T=n(452),N=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.closeLabel=T.e.closeLabel;n._isWacEditBlock=t.isWacEditBlock;n._item=t.item;n.addBindingHandlers({keyboard:m.e});n._userStateProvider=n.resources.consume(y.y);n._unfreezeHelper=n.resources.consume(b.e);n.circleComponent=n._getIconComponent(new f.e("FullCircleMask"));n.title=n._getTitle();n.message=n._getMessage();n.buttonItems=n._getButtonItems();n.classes=n._getClasses();n.imageUrl=n._getImageUrl();n.statusVisible=n.createObservable(!1);n.hasError=n.createObservable(!1);n.status=n.createObservable("");return n}t.prototype.dismiss=function(){var e=this.resources.consume(d.e).currentDialog();if(e){e.dismiss();return!1}return!0};t.prototype.onKeyEnter=function(e,t){e&&e.onClick&&e.onClick();return!0};t.prototype._getTitle=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===h.e.delinquent)return x.e.frozenTitle;if(e===h.e.inactive)return x.e.inactivityFrozenTitle;var t=this._userStateProvider.status.peek();return t===c.e.overQuota?x.e.willBeFrozenTitle:t===c.e.full?x.e.fullTitle:x.e.outOfSpaceTitle};t.prototype._getMessage=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===h.e.delinquent){var t=this._userStateProvider.driveDeletionDate.peek();return a.format(x.e.delinguencyMessage,C(t))}if(e===h.e.inactive){t=this._userStateProvider.driveDeletionDate.peek();return a.format(x.e.inactivityFrozenMessage,C(t))}var n=this._userStateProvider.status.peek();return this._isWacEditBlock?S.e.subHeader:n===c.e.overQuota?x.e.willBeFrozenSubHeader:x.e.noSpaceMessage};t.prototype._getButtonItems=function(){var e=this,t=[],n=this._userStateProvider.primaryLockedReason.peek(),r=this._userStateProvider.canUpgrade.peek();if(n===h.e.inactive)return[{link:void 0,text:x.e.unfreezeButtonText,icon:this._getIconComponent(new f.e("Snowflake")),onClick:function(){e._unlockAccount()}}];r&&t.push({link:void 0,text:x.e.officeStorageOffer,icon:this._getIconComponent(new f.e("OneDrive")),onClick:function(){e._navigate(g.e.upgrade,!1)}});var i=n===h.e.delinquent,s=this._userStateProvider.lastUnlockDate.peek();i&&(this._userStateProvider.userUnlocksRemaining.peek()?t.push({link:void 0,text:x.e.unfreezeButtonText,icon:this._getIconComponent(new f.e("Snowflake")),onClick:function(){e._confirmUnfreeze()}}):s&&t.push({link:{text:x.e.learnMore,onClick:function(){e._navigate(g.e.learnMore,!0)}},text:a.format(x.e.previousThaw,C(s)),icon:this._getIconComponent(new f.e("Snowflake")),onClick:void 0}));i||this._isWacEditBlock&&r||t.push({link:void 0,text:x.e.cleanUpFiles,icon:this._getIconComponent(new f.e("Broom")),onClick:function(){e._navigate(g.e.cleanUpFiles,!1)}});!i&&this._isWacEditBlock&&t.push({link:void 0,text:S.e.readOnlyButton,icon:this._getIconComponent(new f.e("Page")),onClick:function(){e._openOfficeDocument()}});return t};t.prototype._getIconComponent=function(e){return{name:l.e.tagName,params:{icon:e}}};t.prototype._getClasses=function(){return{"od-QuotaBlock-blue":this._userStateProvider.primaryLockedReason.peek()===h.e.inactive||this._userStateProvider.status.peek()===c.e.full&&!this._userStateProvider.canUpgrade.peek()}};t.prototype._getImageUrl=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===h.e.delinquent)return window.require.toUrl("odsp-media/images/quota/frozen-files-red.svg");if(e===h.e.inactive)return window.require.toUrl("odsp-media/images/quota/frozen-files-blue.svg");var t=this._userStateProvider.status.peek();return t===c.e.full?this._userStateProvider.canUpgrade.peek()?window.require.toUrl("odsp-media/images/quota/full-glass-red.svg"):window.require.toUrl("odsp-media/images/quota/full-glass-blue.svg"):t===c.e.overQuota?window.require.toUrl("odsp-media/images/quota/freezing-files-red.svg"):window.require.toUrl("odsp-media/images/quota/speedometer-red.svg")};t.prototype._navigate=function(e,t){var n=2===this._userStateProvider.accountState.peek()?p.e.frozenBlock:p.e.quotaBlock,r=this._userStateProvider.getNavigationUrl(n,e),i=this.resources.consume(v.e),s=new(this.managed(i.NavigationAction))({target:t?"_blank":void 0,url:r});this._userStateProvider.logEvent(n,e);s.execute(void 0)};t.prototype._openOfficeDocument=function(){var e=this,t=new(this.managed(E.e))({item:this._item,forceReadOnly:!0});this._userStateProvider.logEvent(p.e.quotaBlock,g.e.wac);t.execute(void 0).then(function(){var t=e.resources.consume(d.e).currentDialog.peek();t&&t.dismiss()})};t.prototype._confirmUnfreeze=function(){this._unfreezeHelper.confirmUnfreezeWithDialog()};t.prototype._unlockAccount=function(){var e=this;this.hasError(!1);this.status(x.e.requestingUnlock);this.statusVisible(!0);this._userStateProvider.unlockAccount().then(function(){e.statusVisible(!1)},function(){e.status(x.e.genericError);e.hasError(!0);e.statusVisible(!0)})};return t})(o.t);function C(e){return w.e.getLongDateStringSafe(e,u.e.language)}var k=i.e({tagName:"od-quota-block",template:'<div class="od-QuotaBlock" data-bind="css:classes"><div class="od-QuotaBlock-header"><div class="od-QuotaBlock-container"><img class="od-QuotaBlock-image" data-bind="attr:{src:imageUrl}"><div class="od-QuotaBlock-title" data-bind="text:title"></div></div></div><div class="od-QuotaBlock-body"><div class="od-QuotaBlock-subheader"><span class="od-QuotaBlock-message" data-bind="text:message"></span></div><div class="od-QuotaBlock-buttons" data-bind="foreach:buttonItems">\x3c!--ko if:link--\x3e<div class="od-QuotaBlock-button"><div class="od-QuotaBlock-icon"><div class="od-QuotaBlock-outer-icon" data-bind="component:$component.circleComponent"></div><div class="od-QuotaBlock-inner-icon" data-bind="component:icon"></div></div><div class="od-QuotaBlock-message-container"><div class="od-QuotaBlock-text-container"><div class="od-QuotaBlock-text" data-bind="text:text"></div><a class="od-QuotaBlock-button-link" href="javascript:;" data-bind="click:link.onClick,text:link.text"></a></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:link--\x3e<div class="od-QuotaBlock-button od-QuotaBlock-button--clickable" tabindex="0" data-bind="click:onClick,keyboard:{allowButtonEvents:true,mappings:{Enter:$component.onKeyEnter}}"><div class="od-QuotaBlock-icon"><div class="od-QuotaBlock-outer-icon" data-bind="component:$component.circleComponent"></div><div class="od-QuotaBlock-inner-icon" data-bind="component:icon"></div></div><div class="od-QuotaBlock-message-container"><div class="od-QuotaBlock-text-container"><div class="od-QuotaBlock-text" data-bind="text:text"></div></div></div></div>\x3c!--/ko--\x3e</div><div aria-live="assertive" role="status" class="od-QuotaBlock-status">\x3c!--ko if:statusVisible--\x3e<p data-bind="text:status,css:hasError()?\'od-QuotaBlock-error\':\'\'"></p>\x3c!--/ko--\x3e</div></div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':closeLabel,title:closeLabel},click:dismiss"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>',viewModel:N,synchronous:!0});t.e=k},"2657":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(9),s=n(40),o=n(291),u=n(1512),a=n(11);Object(a.n)([{rawString:".od-Thawing{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:12px 28px}.od-Thawing-title{font-size:21px;font-weight:100;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:4px;text-align:center}.od-Thawing-image{height:134px;width:100%;margin-left:-5px;padding:8px 4px 8px 0}html[dir=rtl] .od-Thawing-image{padding:8px 0 8px 4px}.od-Thawing-footer{padding:4px;text-align:center}.od-Thawing-message{font-size:14px;font-weight:400;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}]);var f=n(16),l=n(1286),c=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.title=l.e.thawingTitle1;n.message=l.e.thawingMessage1;n.imageUrl=window.require.toUrl("odsp-media/images/quota/thawing.svg");return n}return t})(i.t),h=f.e({tagName:"od-thawing",template:'<div class="od-Thawing"><div class="od-Thawing-title" data-bind="text:title"></div><img class="od-Thawing-image" data-bind="attr:{src:imageUrl}"><div class="od-Thawing-footer"><div class="od-Thawing-message" data-bind="text:message"></div></div></div>',viewModel:c,synchronous:!0}),p=n(1946),d=n(124),v=n(32),m=n(12),g=n(6),y=n(261),b=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._userStateProvider=n.resources.consume(v.y);n._viewParams=n.resources.consume(g.H);n._urlDataSource=n.resources.consume(y.n);n.createComputed(n._computeShowFrozenBlock);n.createComputed(n._computeShowThawingDialog);return n}t.prototype._computeShowFrozenBlock=function(){var e=1===this._userStateProvider.accountState(),n=this._userStateProvider.isSoftLocked(),r=this._urlDataSource.getPageType(this._viewParams()),i=r===m.e.StorageOptions||r===m.e.StorageInfo;if(t._frozenDialog){if(e||n||i){var a=t._frozenDialog;t._frozenDialog=null;a.dismiss();a.dispose()}}else{var f=this._userStateProvider.primaryLockedReason();if(e||f!==u.e.delinquent&&f!==u.e.inactive||n||i){if(f===u.e.other){var l=this._userStateProvider.getSuspendedUrl();this.resources.consume(s.e).navigateTo({url:l})}}else{var c=this.resources.consume(d.e);t._frozenDialog=c.requestDialog({template:0,style:o.e.blocker,isDismissable:!1,queueDialog:!0,component:{name:p.e.tagName,params:{resources:this.resources}}})}}};t.prototype._computeShowThawingDialog=function(){var e=this._userStateProvider.isSoftLocked(),n=this._userStateProvider.isUnlockInProgress();if(t._thawingDialog){if(!n){var r=t._thawingDialog;t._thawingDialog=null;r.dismiss();r.dispose()}}else if(n&&!e){var i=this.resources.consume(d.e);t._thawingDialog=i.requestDialog({template:0,style:o.e.blocker,isDismissable:!1,component:{name:h.tagName,params:{resources:this.resources}}})}};return t})(i.t);t.default=b}}]);